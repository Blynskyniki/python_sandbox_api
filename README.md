üì¶ Python Sandbox API

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP API-—Å–µ—Ä–≤–∏—Å –Ω–∞ FastAPI –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ Python-–∫–æ–¥–∞ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏, –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ .env.

### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: **numpy** **pandas**

‚∏ª

üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ \
‚Ä¢ üîê –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–¥–∞ \
‚Ä¢ ‚è± –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ CPU –∏ –æ–±—ä—ë–º—É –ø–∞–º—è—Ç–∏
**(5s CPU && 512mb RAM)** \
‚Ä¢ üß† –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (–≤–∫–ª—é—á–∞—è —Å–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã) \
‚Ä¢ ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ .env \
‚Ä¢ üßæ –û—Ç–≤–µ—Ç —Å stdout, stderr, exit_code

‚∏ª

üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

git clone python-sandbox-api
cd python-sandbox-api
python -m venv venv
source venv/bin/activate # –∏–ª–∏ venv\Scripts\activate –Ω–∞ Windows
pip install -r requirements.txt

–°–æ–∑–¥–∞–π .env:

CPU_LIMIT_SECONDS=2
MEMORY_LIMIT_MB=64
EXEC_TIMEOUT_SECONDS=3

‚∏ª

üèÅ –ó–∞–ø—É—Å–∫

```
uvicorn main:app --reload

```

‚∏ª

üì° API

POST /run

–ó–∞–ø—É—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–¥–∞.

üî∏ –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON)

```
{
  "code": "def run(user): return f\"{user['first_name']} {user['last_name']}\"",
  "args": [
    {
      "first_name": "–ò–≤–∞–Ω",
      "last_name": "–ü–µ—Ç—Ä–æ–≤"
    }
  ]
}
```

**–í–∞–∂–Ω–æ: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω def run(...), –∏–º–µ–Ω–Ω–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏.**

üî∏ –û—Ç–≤–µ—Ç (JSON)

{
"stdout": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
"stderr": "",
"exit_code": 0
}

üî∏ –û—à–∏–±–∫–∏
‚Ä¢ 400: –æ—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤
‚Ä¢ 408: –ø—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
‚Ä¢ 422: –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞
‚Ä¢ 500: –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞

‚∏ª

üß™ –ü—Ä–∏–º–µ—Ä —Å curl

curl -X POST http://localhost:8000/run \
-H "Authorization: Basic c2FuZGJveDpzZWNyZXQxMjM=" \
-H "Content-Type: application/json" \
-d '{
"code": "def run(user): return f\"{user[\'first_name\']} {user[\'last_name\']}\"",
"args": [{"first_name": "–ò–≤–∞–Ω", "last_name": "–ü–µ—Ç—Ä–æ–≤"}]
}'

‚∏ª

üõ° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚Ä¢ –ù–∞ Linux –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è resource.setrlimit –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è CPU –∏ –ø–∞–º—è—Ç–∏.
‚Ä¢ –ù–∞ –¥—Ä—É–≥–∏—Ö –û–° –ª–∏–º–∏—Ç—ã –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è.
‚Ä¢ –î–ª—è –±–æ–ª–µ–µ –Ω–∞–¥—ë–∂–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ –∫–æ–¥–∞ –≤ Docker –∏–ª–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º gVisor/Firejail.

‚∏ª

üìÇ –§–∞–π–ª—ã

–§–∞–π–ª –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
main.py –û—Å–Ω–æ–≤–Ω–æ–π API-—Å–µ—Ä–≤–µ—Ä
.env –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
requirements.txt –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (fastapi, python-dotenv)

